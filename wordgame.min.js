function wordGame(){}
(function(){function E(){c.attr("disabled","disabled");var a=r.height(),b=r.width()/2-m.width()/2,a=a/2-m.height()/2,d=(new Date).getTime()/1E3-startTime;F();n.addClass("finish");$("#f-score").html("Score: "+score);$("#f-time").html(d.toFixed()+" sec");$("#f-wpm").html(t.html());$("#f-errors").html(errors+" error"+(1<errors?"s":""));m.css({top:a,left:b}).show()}function M(){gametype=$("#options-wrapper input:checked").data("type");"timed"===gametype&&(u=setTimeout(function(){G()},1E4));$("#options-wrapper input").attr("disabled",
"disabled")}function G(){clearTimeout(u);var a=5E3,b=Date.now()/1E3-startTime;b>=H?E():(b>=H-1E4&&(a=500),u=setTimeout(function(){G()},a))}function N(){c.on("keydown",function(a){if(a.keyCode===f.BACKSP&&lastKey===f.SPACE)return a.preventDefault(),!1}).on("keyup",function(a){if(a.keyCode===f.BACKSP&&lastKey===f.SPACE)lastKey=a.keyCode;else if(a.keyCode===f.ESC||a.keyCode===f.ENTER)c.val("");else if(a.keyCode===f.SPACE)c.val(this.value.substring(0,this.value.length-1)),lastKey=a.keyCode;else if(0==
this.value.length)p("#333","#000");else{lastKey=a.keyCode;a=this.value;var b=Date.now()/1E3,s,v=!1,A,h=!1,e=!1;null===startTime&&(startTime=b,e=!0,M());characters++;for(x in d)e&&(d[x].ts=b),s=d[x].word.substring(0,a.length)===a,lengthMatches=d[x].word.length===a.length,A=!h&&!s&&b-d[x].ts>q[g].timeout,s&&lengthMatches||A?(v=!0,I($("#w"+d[x].id),x),A?h=!0:(p("#333","#000"),c.val(""),score++,B.html(score).animate({color:"#fff047"},300).delay(100).animate({color:"#f1f1f1"},300),1==score&&c.removeAttr("placeholder"),
null!=q[g].score&&score>=q[g].score&&(g++,C.html("Lvl "+(g+1))),F(),score>=O&&"words"===gametype&&E())):!1===v&&s&&(p("#2d2b4e","#190eb5"),v=!0,d[x].ts=b,$("#w"+d[x].id).css({zIndex:2}));!1===v?inerror||(errors++,inerror=!0,p("#58282e","#E0001E")):inerror=!1;5>k&&l()}});n.on("click","li",function(){var a=$(this);I(a,a.data("id"));c.focus();5>k&&l()});$("#reset, #finish-button").click(function(){clearTimeout(u);p("#333","#000");errors=characters=score=g=0;lastKey=gametype=endTime=startTime=null;c.val("").removeAttr("disabled").focus();
$("#options-wrapper input").removeAttr("disabled","disabled");B.html("0");C.html("Lvl 1");t.html("");m.hide();n.removeClass("finish");c.attr("placeholder","Start typing!");l()});$("#wordnik a").click(function(){window.open(this.href);return!1});$("#loadit").click(function(){l()})}function I(a,b){a.fadeOut(300).queue(function(){$(this).remove()});k--;delete d[b]}function p(a,b){P.css({backgroundColor:a});c.css({color:b})}function F(){var a=(Date.now()/1E3-startTime)/60;t.html(Math.round(score/a)+" WPM")}
function D(){J=setTimeout(function(){l()},Q)}function l(){!0===w?D():(clearTimeout(J),w=!0,k===K?(w=!1,D()):(y.limit=K-k+5,y.minLength=q[g].minLength,y.maxLength=q[g].maxLength,$.ajax("http://api.wordnik.com/v4/words.json/randomWords",{data:y,dataType:"jsonp"}).done(function(a){for(var b=r.height(),c=r.width(),g=Date.now()/1E3,f=[],h,e=0;e<a.length&&!(10<=k);e++)k++,d[a[e].id]={id:a[e].id,word:a[e].word.toLowerCase(),ts:g},h=$('<li id="w'+a[e].id+'" data-id="'+a[e].id+'" style="display:none;">'+d[a[e].id].word+
"</li>"),h.css({backgroundColor:R[z],left:Math.floor(Math.random()*(c-L-h.width()))+1,top:Math.floor(Math.random()*(b-L-220-h.height()))+100}).fadeIn(300).delay(300),f.push(h),z++,10==z&&(z=0);n.append(f)}).always(function(){D();w=!1})))}$(window);var r=$(document),P=$("body"),L=20,Q=5E3,H=60,O=100,R="#ECD078 #D95B43 #C02942 #542437 #53777A #003366 #FFCC00 #53004B #77BED2 #F2583E".split(" "),z=0,c,n,B,C,t,m,J=null,u=null,K=10,k=0,w=!1,d={},y={api_key:"740916580801827774344013e130d4be97817a950b357cc36",
hasDictionaryDef:!0,minLength:3,maxLength:7,minCorpusCount:100,minDictionaryCount:2},g=0,q=[{score:10,minLength:3,maxLength:4,timeout:30},{score:25,minLength:4,maxLength:5,timeout:30},{score:50,minLength:4,maxLength:6,timeout:40},{score:80,minLength:5,maxLength:7,timeout:40},{score:120,minLength:5,maxLength:9,timeout:60},{score:150,minLength:5,maxLength:10,timeout:60},{score:200,minLength:5,maxLength:12,timeout:80},{score:300,minLength:5,maxLength:14,timeout:80},{score:null,minLength:10,maxLength:15,
timeout:90}],f={ESC:27,ENTER:13,SPACE:32,BACKSP:8};errors=characters=score=0;inerror=!1;gametype=endTime=startTime=lastKey=null;this.init=function(){n=$("#worddisplay");c=$("#typebox").focus();B=$("#score");C=$("#level");t=$("#wpm");m=$("#finish-dialog");N();l()}}).apply(wordGame);$(document).ready(function(){wordGame.init()});