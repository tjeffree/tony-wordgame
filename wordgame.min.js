function wordGame(){}
(function(){function G(){e.attr("disabled","disabled");var a=u.height(),n=u.width()/2-q.width()/2,a=a/2-q.height()/2,b=(new Date).getTime()/1E3-startTime;H();g.addClass("finish");$("#f-score").html("Score: "+score);$("#f-time").html(b.toFixed()+" sec");$("#f-wpm").html(v.html());0<errors?$("#f-errors").html(errors+" error"+(1<errors?"s":"")):$("#f-errors").html("No errors");$("#tweetBtn iframe").remove();var d=document.createElement("a");d.className="twitter-share-button";d.href="https://twitter.com/share";
d.setAttribute("data-url","http://shex.co.uk/wordgame/");d.setAttribute("data-count","none");d.setAttribute("data-size","large");d.setAttribute("data-text","I scored "+score+" words in "+b.toFixed()+" seconds on this Word Game. Give it a try!");document.getElementById("tweetBtn").innerHTML="";document.getElementById("tweetBtn").appendChild(d);twttr.widgets.load();q.css({top:a,left:n}).show()}function L(){gametype=$("#options-wrapper input:checked").data("type");"timed"===gametype&&(w=setTimeout(function(){I()},
1E4));$("#options-wrapper input").attr("disabled","disabled")}function I(){clearTimeout(w);var a=5E3,b=Date.now()/1E3-startTime;60<=b?G():(-9940<=b&&(a=500),w=setTimeout(function(){I()},a))}function M(){e.on("keydown",function(a){if(a.keyCode===k.BACKSP&&lastKey===k.SPACE)return a.preventDefault(),!1}).on("keyup",function(a){if(a.keyCode===k.BACKSP&&lastKey===k.SPACE)lastKey=a.keyCode;else if(a.keyCode===k.ESC||a.keyCode===k.ENTER)e.val("");else if(a.keyCode===k.SPACE)e.val(this.value.substring(0,
this.value.length-1)),lastKey=a.keyCode;else if(0==this.value.length)r("#333","#000");else{lastKey=a.keyCode;a=this.value;var n=Date.now()/1E3,g,d=!1,B,h=!1,f=!1;null===startTime&&(startTime=n,f=!0,L());characters++;for(x in b)f&&(b[x].ts=n),g=b[x].word.substring(0,a.length)===a,lengthMatches=b[x].word.length===a.length,B=!h&&!g&&n-b[x].ts>t[l].timeout,g&&lengthMatches||B?(d=!0,J($("#w"+b[x].id),x),B?h=!0:(r("#333","#000"),e.val(""),score++,C.html(score).animate({color:"#fff047"},300).delay(100).animate({color:"#f1f1f1"},
300),1==score&&e.removeAttr("placeholder"),null!=t[l].score&&score>=t[l].score&&(l++,D.html("Lvl "+(l+1))),H(),100<=score&&"words"===gametype&&G())):!1===d&&g&&(r("#2d2b4e","#190eb5"),d=!0,b[x].ts=n,$("#w"+b[x].id).css({zIndex:2}));!1===d?inerror||(errors++,inerror=!0,r("#58282e","#E0001E")):inerror=!1;5>p&&c()}});g.on("click","li",function(){var a=$(this);J(a,a.data("id"));e.focus();5>p&&c()});$("#reset, #finish-button").click(function(){clearTimeout(w);r("#333","#000");errors=characters=score=l=
0;lastKey=gametype=endTime=startTime=null;e.val("").removeAttr("disabled").focus();$("#options-wrapper input").removeAttr("disabled","disabled");C.html("0");D.html("Lvl 1");v.html("");q.hide();g.removeClass("finish");e.attr("placeholder","Start typing!");c()});$("#wordnik a").click(function(){window.open(this.href);return!1});$("#loadit").click(function(){c()});window.onresize=function(){p=0;g.empty();b={};E=setTimeout(function(){c()},300)}}function J(a,n){a.fadeOut(300).queue(function(){$(this).remove()});
p--;delete b[n]}function r(a,b){N.css({backgroundColor:a});e.css({color:b})}function H(){var a=(Date.now()/1E3-startTime)/60;v.html(Math.round(score/a)+" WPM")}function F(){E=setTimeout(function(){c()},5E3)}function c(){!0===y?F():(clearTimeout(E),y=!0,10===p?(y=!1,F()):(z.limit=10-p+5,z.minLength=t[l].minLength,z.maxLength=t[l].maxLength,$.ajax("http://api.wordnik.com/v4/words.json/randomWords",{data:z,dataType:"jsonp"}).done(function(a){for(var e=u.height()-115,l=u.width(),d=Date.now()/1E3,k=[],
h,f,c,m=0;m<a.length&&!(10<=p);m++)p++,/^[a-z]+$/i.test(a[m].word)&&(b[a[m].id]={id:a[m].id,word:a[m].word.toLowerCase(),ts:d},h=document.createElement("li"),h.id="w"+a[m].id,h.setAttribute("data-id",a[m].id),f=document.createElement("div"),f.className="word",f.innerHTML=b[a[m].id].word,f.setAttribute("style","background-color: "+O[A]),h.appendChild(f),K.appendChild(h),c=f.getBoundingClientRect(),K.removeChild(h),f=l-c.width,c=e-c.height,f=(Math.random()*f).toFixed(),c=(Math.random()*c+110).toFixed(),
h.setAttribute("style","left: "+f+"px; top : "+c+"px"),k.push(h),A++,10==A&&(A=0));g.append(k)}).always(function(){F();y=!1;setTimeout(function(){$(".word").addClass("active")},10)})))}$(window);var u=$(document),N=$("body"),K=document.getElementById("output-check"),O="#ECD078 #D95B43 #C02942 #542437 #53777A #003366 #FFCC00 #53004B #77BED2 #F2583E".split(" "),A=0,e,g,C,D,v,q,E=null,w=null,p=0,y=!1,b={},z={api_key:"740916580801827774344013e130d4be97817a950b357cc36",hasDictionaryDef:!0,minLength:3,
maxLength:7,minCorpusCount:100,minDictionaryCount:2},l=0,t=[{score:10,minLength:3,maxLength:4,timeout:30},{score:25,minLength:4,maxLength:5,timeout:30},{score:50,minLength:4,maxLength:6,timeout:40},{score:80,minLength:5,maxLength:7,timeout:40},{score:120,minLength:5,maxLength:9,timeout:60},{score:150,minLength:5,maxLength:10,timeout:60},{score:200,minLength:5,maxLength:12,timeout:80},{score:300,minLength:5,maxLength:14,timeout:80},{score:null,minLength:10,maxLength:15,timeout:90}],k={ESC:27,ENTER:13,
SPACE:32,BACKSP:8};errors=characters=score=0;inerror=!1;gametype=endTime=startTime=lastKey=null;this.init=function(){g=$("#worddisplay");e=$("#typebox").focus();C=$("#score");D=$("#level");v=$("#wpm");q=$("#finish-dialog");M();c()}}).apply(wordGame);$(document).ready(function(){wordGame.init()});
